## 베이즈이론 기반

20.10.13

강수확률 70% ? 날씨예측: 확률기반, 과거 데이터를 사용 -> 미래 예측

#### 베이즈이론

- 베이지안 필터기(여기서는 메일분류를 위해 만들지만 다른 분야에서도 많이 사용된다). 
  - ex) 보안(네트워크망에 침투할때, 침투하기 전 특이 행동,페턴을 하는데 그 페턴을 통해서 밝힘)) 
- 베이지안 분류기: 결과에 대한 전체 확률(스팸확률? 햄확률?)을 알기 위해 동시에 여러가지 속성에 대한 정보를 고려해야하는 문제에 사용 적절
- 분류기, 증상을 관찰하고 의학적 질병 진단.

- 조건부이론

#### 베이지안 확률

- 사건에 대한 우도(likelihood) 는 여러번의 시행(trials, 사건이 발생할 수 있도록 하는 시도)에서 사용할 수 있는 증거를 기반으로 추정한다.
  - ​    **시행**		    		  **사건**
  - 동전던지기	         앞면결과
  - 받은이메일             메일이 스팸
  - 로또 구매               로또 당첨
  
- 확률?
  - 사전 확률(prior prob) P(A) or P(B): 받은 메시지의 내용을 모르는 상태에서, 메시지의 스팸 상태를 가장 잘 예측하는 방법은?
  - 사건 확률 : 관측 데이터에서 사건이 발생한 시행 횟수를 전체 시행 횟수로 나눔
    - P(비)=0.3, P(로또당첨)=0.00000001
  
- 우도(likelihood): P(B|A)
  - 메일 제목 : 형님 저 유재석 입니다. 저희 나이트 언제 오실건가요? 
  - '나이트' 단어가 나타났던 빈도를 관측하려면 이전에 받았던 이메일을 살펴보면 정보를 알 수 있음
  - 이전 스팸 메시지에서 '나이트' 단어가 사용된 확률: P(나이트|스팸): 스팸이 생겼을때 나이트일 확률
  
- 사후(posterior) 확률: 메시지가 스팸이 될 확률을 측정
  
- 사후확률 = 우도*사전확률 / 주변우도
  
  $$
  P(A│B)=(P(B│A)P(A))/P(B)
  $$
  
  
  
- 전체확률 법칙: 원노트



독립사건 : 사건들간에 서로 관계가 없음 <- 나이브(단순)하게 모든 사건을 독립적인 사건으로 간주해 복잡성을 낮춘다.

종속사건 : 사건들간에 서로 관계가 있음 (이걸 전제로 문제해결) : 예측 모델링의 기반이 된다.

책: 나의 첫 머신러닝/딥러닝 참고



### 라플라스 추정치

- 라이브러리에서 우도표를 만들어 준다.
  - **고려사항** : 우도표 만들때, 우도표에 등장하는 단어들은 이제까지 받은 전체 매일에 등장하는 모든 단어들이 우도표에 모두 들어가야 한다. 
- 예를 들어 10년동안 1만여 통의 매일을 받았을경우 단어수가 무수히 많다. w1~w10000 그런데 우연히 w중 하나가 값이 전혀 없는 0일경우 계산할때 값이 0이 되어버리는 경우가 있어서 **라플라스 추정치**를 사용한다. 디폴트가 1로 설정되어져 있다.
- 빈도수에 (분자) 1을 추가해준다. 그러면 0이 되지않는다. <u>R에는 옵션이 있다</u>.

